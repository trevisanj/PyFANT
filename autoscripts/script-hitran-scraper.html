

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Script hitran-scraper.py &mdash; PyFANT 19.12.04 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Script link.py" href="script-link.html" />
    <link rel="prev" title="Script cut-molecules.py" href="script-cut-molecules.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PyFANT
          

          
          </a>

          
            
            
              <div class="version">
                19.12.04
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding.html">Coding using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Index of applications (scripts)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyFANT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../scripts.html">Index of applications (scripts)</a> &raquo;</li>
        
      <li>Script <code class="docutils literal notranslate"><span class="pre">hitran-scraper.py</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/autoscripts/script-hitran-scraper.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="script-hitran-scraper-py">
<h1>Script <code class="docutils literal notranslate"><span class="pre">hitran-scraper.py</span></code><a class="headerlink" href="#script-hitran-scraper-py" title="Permalink to this headline">¶</a></h1>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>usage: hitran-scraper.py [-h] [-t T] [M] [I] [llzero] [llfin]

Retrieves molecular lines from the HITRAN database [Gordon2016]

This script uses web scraping and the HAPI to save locally molecular lines from the HITRAN database.

While the HAPI provides the downloading facility, web scraping is used to get the lists of molecules
and isotopologues from the HITRAN webpages and get the IDs required to run the HAPI query.

The script is typically invoked several times, each time with an additional argument.

References:

[Gordon2016] I.E. Gordon, L.S. Rothman, C. Hill, R.V. Kochanov, Y. Tan, P.F. Bernath, M. Birk,
    V. Boudon, A. Campargue, K.V. Chance, B.J. Drouin, J.-M. Flaud, R.R. Gamache, J.T. Hodges,
    D. Jacquemart, V.I. Perevalov, A. Perrin, K.P. Shine, M.-A.H. Smith, J. Tennyson, G.C. Toon,
    H. Tran, V.G. Tyuterev, A. Barbe, A.G. Császár, V.M. Devi, T. Furtenbacher, J.J. Harrison,
    J.-M. Hartmann, A. Jolly, T.J. Johnson, T. Karman, I. Kleiner, A.A. Kyuberis, J. Loos,
    O.M. Lyulin, S.T. Massie, S.N. Mikhailenko, N. Moazzen-Ahmadi, H.S.P. Müller, O.V. Naumenko,
    A.V. Nikitin, O.L. Polyansky, M. Rey, M. Rotger, S.W. Sharpe, K. Sung, E. Starikova,
    S.A. Tashkun, J. Vander Auwera, G. Wagner, J. Wilzewski, P. Wcisło, S. Yu, E.J. Zak,
    The HITRAN2016 Molecular Spectroscopic Database, J. Quant. Spectrosc. Radiat. Transf. (2017).
    doi:10.1016/j.jqsrt.2017.06.038.

positional arguments:
  M           HITRAN molecule number (default: (lists molecules))
  I           HITRAN isotopologue number (not unique, starts over at each
              molecule) (default: (lists isotopologues))
  llzero      Initial wavelength (Angstrom) (default: None)
  llfin       Final wavelength (Angstrom) (default: None)

optional arguments:
  -h, --help  show this help message and exit
  -t T        Table Name (default: (molecular formula))
</pre></div>
</div>
<p>This script belongs to package <em>pyfant</em></p>
<div class="section" id="usage-examples">
<h2>Usage examples<a class="headerlink" href="#usage-examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ hitran-scraper.py

List of all HITRAN <span class="nv">molecules</span>
<span class="o">============================</span>

  ID  Formula    Name
----  ---------  --------------------
   <span class="m">1</span>  H2O        Water
   <span class="m">2</span>  CO2        Carbon Dioxide
   <span class="m">3</span>  O3         Ozone
   <span class="m">4</span>  N2O        Nitrous Oxide
   <span class="m">5</span>  CO         Carbon Monoxide
   <span class="m">6</span>  CH4        Methane
   <span class="m">7</span>  O2         Molecular Oxygen
   <span class="m">8</span>  NO         Nitric Oxide
   <span class="m">9</span>  SO2        Sulfur Dioxide
  <span class="m">10</span>  NO2        Nitrogen Dioxide
  <span class="m">11</span>  NH3        Ammonia
  <span class="m">12</span>  HNO3       Nitric Acid
  <span class="m">13</span>  OH         Hydroxyl Radical
  <span class="m">14</span>  HF         Hydrogen Fluoride
  <span class="m">15</span>  HCl        Hydrogen Chloride
  <span class="m">16</span>  HBr        Hydrogen Bromide
  <span class="m">17</span>  HI         Hydrogen Iodide
  <span class="m">18</span>  ClO        Chlorine Monoxide
  <span class="m">19</span>  OCS        Carbonyl Sulfide
  <span class="m">20</span>  H2CO       Formaldehyde
  <span class="m">21</span>  HOCl       Hypochlorous Acid
  <span class="m">22</span>  N2         Molecular Nitrogen
  <span class="m">23</span>  HCN        Hydrogen Cyanide
  <span class="m">24</span>  CH3Cl      Methyl Chloride
  <span class="m">25</span>  H2O2       Hydrogen Peroxide
  <span class="m">26</span>  C2H2       Acetylene
  <span class="m">27</span>  C2H6       Ethane
  <span class="m">28</span>  PH3        Phosphine
  <span class="m">29</span>  COF2       Carbonyl Fluoride
  <span class="m">31</span>  H2S        Hydrogen Sulfide
  <span class="m">32</span>  HCOOH      Formic Acid
  <span class="m">33</span>  HO2        Hydroperoxyl Radical
  <span class="m">34</span>  O          Oxygen Atom
  <span class="m">36</span>  NO+        Nitric Oxide Cation
  <span class="m">37</span>  HOBr       Hypobromous Acid
  <span class="m">38</span>  C2H4       Ethylene
  <span class="m">39</span>  CH3OH      Methanol
  <span class="m">40</span>  CH3Br      Methyl Bromide
  <span class="m">41</span>  CH3CN      Methyl Cyanide
  <span class="m">43</span>  C4H2       Diacetylene
  <span class="m">44</span>  HC3N       Cyanoacetylene
  <span class="m">45</span>  H2         Molecular Hydrogen
  <span class="m">46</span>  CS         Carbon Monosulfide
  <span class="m">47</span>  SO3        Sulfur trioxide

Now, to list isotopologues <span class="k">for</span> a given molecule, please type:

    hitran-scraper.py &lt;molecule ID&gt;

where &lt;molecule ID&gt; is one of the IDs listed above.
</pre></div>
</div>
<p>Now suppose we want the molecule OH molecule:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ hitran-scraper.py <span class="m">13</span>

List of all isotopologues <span class="k">for</span> molecule <span class="s1">&#39;OH&#39;</span> <span class="o">(</span>Hydroxyl Radical<span class="o">)</span>
<span class="o">==============================================================</span>

m_formula      ID    ID_molecule  Formula      AFGL_Code  Abundance
-----------  ----  -------------  ---------  -----------  ---------------
OH              <span class="m">1</span>             <span class="m">13</span>  <span class="o">(</span><span class="m">16</span><span class="o">)</span>OH              <span class="m">61</span>  <span class="m">0</span>.997473
OH              <span class="m">2</span>             <span class="m">13</span>  <span class="o">(</span><span class="m">18</span><span class="o">)</span>OH              <span class="m">81</span>  <span class="m">0</span>.002
OH              <span class="m">3</span>             <span class="m">13</span>  <span class="o">(</span><span class="m">16</span><span class="o">)</span>OD              <span class="m">62</span>  <span class="m">1</span>.553710 × <span class="m">10</span>-4


Now, to download lines, please type:

    hitran-scraper.py <span class="m">13</span> &lt;isotopologue ID&gt; &lt;llzero&gt; &lt;llfin&gt;

where &lt;isotopologue ID&gt; is one the numbers from the <span class="s1">&#39;ID&#39;</span> column above,

and <span class="o">[</span>&lt;llzero&gt;, &lt;llfin&gt;<span class="o">]</span> defines the wavelength interval in Angstrom.
</pre></div>
</div>
<p>Now selecting the first isotopologue and specifying the visible wavelength range:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ hitran-scraper.py <span class="m">13</span> <span class="m">1</span> <span class="m">3000</span> <span class="m">7000</span>

Isotopologue selected:
<span class="o">======================</span>

Field name    Value
------------  --------
m_formula     OH
ID            <span class="m">1</span>
ID_molecule   <span class="m">13</span>
Formula       <span class="o">(</span><span class="m">16</span><span class="o">)</span>OH
AFGL_Code     <span class="m">61</span>
Abundance     <span class="m">0</span>.997473

Wavelength interval <span class="o">(</span>air<span class="o">)</span>: <span class="o">[</span><span class="m">3000</span>.0, <span class="m">7000</span>.0<span class="o">]</span> Angstrom
Wavenumber interval <span class="o">(</span>vacuum<span class="o">)</span>: <span class="o">[</span><span class="m">14289</span>.61969369552, <span class="m">33342</span>.42546386186<span class="o">]</span> cm**-1
Table name: <span class="s1">&#39;(16)OH&#39;</span>

Fetching data...
<span class="o">===</span>
<span class="o">===</span> BEGIN messages from HITRAN <span class="nv">API</span> <span class="o">===</span>
<span class="o">===</span>
BEGIN DOWNLOAD: <span class="o">(</span><span class="m">16</span><span class="o">)</span>OH
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
  <span class="m">65536</span> bytes written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.data
Header written to ./<span class="o">(</span><span class="m">16</span><span class="o">)</span>OH.header
END DOWNLOAD
                     Lines parsed: <span class="m">3855</span>
<span class="nv">PROCESSED</span>
<span class="o">===</span>
<span class="o">===</span> END messages from HITRAN <span class="nv">API</span> <span class="o">===</span>
<span class="o">===</span>
...done
Please check files <span class="s1">&#39;(16)OH.header&#39;</span>, <span class="s1">&#39;(16)OH.data&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-note-on-the-hitran-api">
<h2>Quick note on the HITRAN API<a class="headerlink" href="#quick-note-on-the-hitran-api" title="Permalink to this headline">¶</a></h2>
<p>The files created (‘(16)OH.header’, ‘(16)OH.data’) can be opened using the <a class="reference external" href="http://hitran.org/hapi">HAPI</a>.
They are also accessed by the application <code class="docutils literal notranslate"><span class="pre">convmol.py</span></code>.</p>
<p>The HAPI can be downloaded, but one version is also included with the f311 package. The following
is an example of how the HITRAN data could be accessed from the Python console:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">f311</span> <span class="kn">import</span> <span class="n">hapi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hapi</span><span class="o">.</span><span class="n">loadCache</span><span class="p">()</span>
<span class="go">Using .</span>
<span class="go">(16)OH</span>
<span class="go">                     Lines parsed: 3855</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oh_data</span> <span class="o">=</span> <span class="n">hapi</span><span class="o">.</span><span class="n">LOCAL_TABLE_CACHE</span><span class="p">[</span><span class="s2">&quot;(16)OH&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oh_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;data&#39;, &#39;header&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oh_data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;ierr&#39;, &#39;gpp&#39;, &#39;molec_id&#39;, &#39;global_lower_quanta&#39;, &#39;sw&#39;, &#39;gamma_self&#39;, &#39;n_air&#39;, &#39;elower&#39;, &#39;line_mixing_flag&#39;, &#39;local_lower_quanta&#39;, &#39;gp&#39;, &#39;global_upper_quanta&#39;, &#39;gamma_air&#39;, &#39;local_upper_quanta&#39;, &#39;iref&#39;, &#39;local_iso_id&#39;, &#39;delta_air&#39;, &#39;nu&#39;, &#39;a&#39;])</span>
</pre></div>
</div>
<p>To work properly with these data in your code, you may have a look at the HAPI source code and manual, as this library is
superbly documented.</p>
<p>Within f311, the code in <code class="xref py py-meth docutils literal notranslate"><span class="pre">f311.convmol.conv_hitran.hitran_to_sols()</span></code> contains a usage example of HITRAN data.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="script-link.html" class="btn btn-neutral float-right" title="Script link.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="script-cut-molecules.html" class="btn btn-neutral float-left" title="Script cut-molecules.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, JT

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>